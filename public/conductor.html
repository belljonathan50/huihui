<html>
<head>
	<meta http-equiv="Content-Type" content="text/html;charset=utf-8" >
	<title>Conductor</title>

	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<link href="fonts/fonts.css" rel="stylesheet">
	<link href="missa.css" rel="stylesheet">
	<script src="lib/libINScore.js"></script>
	<script src="lib/INScoreJS.js"></script>
	<script src="lib/timesync.min.js"></script>
	<script src="lib/comm.js"></script>
	<script src="lib/conductor.js"></script>
<body>

<div class="inscore" id="scene">

<pre>
	/ITL/scene/all set img 'rsrc/gonzalo.png';
	/ITL/scene/all duration 330;
	/ITL/scene/all width 1.9;
	/ITL/scene/all y 0.5;
	
	/ITL/scene/cursor set rect 0.005 0.5;
	/ITL/scene/cursor color red;
	/ITL/scene/sync cursor all v;
	/ITL/scene/all watch mouseDown 		( /ITL/scene event GOTO  '$date' );
	/ITL/scene/all watch mouseMove 		( /ITL/scene event GOTO  '$date' );
	
	w = 0.05;
	/ITL/scene/mark set ellipse $w $w;
	/ITL/scene/mark color green;
	/ITL/scene/sync mark all syncTop;
	/ITL/scene watch keyDown ' ' 			( /ITL/scene/control/play event mouseDown 0 0 );
	/ITL/scene watch keyDown 'm' 			( /ITL/scene/mark date '$(/ITL/scene/cursor get date)' );
	/ITL/scene watch keyDown '0' 			( /ITL/scene event GOTO 0 1);
	/ITL/scene watch keyDown '1' 			( /ITL/scene event GOTO '$(/ITL/scene/mark get date)' );
	
	/ITL/scene load 'inscore/player.inscore.txt';
	/ITL/scene watch PLAYREADY ( /ITL/scene/control y 0.8 );
	
	/ITL/scene load 'inscore/parts.inscore.txt';
	/ITL/scene watch PARTSREADY ( /ITL/scene/parts y -0.9,  /ITL/scene/parts x 0.8 );
	
	/ITL/scene load 'inscore/pages.inscore.txt';
	/ITL/scene watch PAGEREADY ( 
		/ITL/scene/page* width 1.95, 
		/ITL/scene/page* y -0.2,
		/ITL/scene/sync cursor page* v,
		/ITL/scene/sync mark page* syncTop,
		/ITL/scene/mark dy -0.2,
		
		/ITL/scene/page* watch mouseDown ( /ITL/scene event GOTO  '$date' ),
		/ITL/scene/page* watch mouseMove ( /ITL/scene event GOTO  '$date' ),
		/ITL/scene event STOP,
		/ITL/scene/javascript run "wsSend('READY')" 
	);
	
	/ITL/scene watch PLAY 	( /ITL/scene/javascript run "play()" );
	/ITL/scene watch PAUSE 	( /ITL/scene/javascript run "pause()" );
	/ITL/scene watch STOP 	( 
		/ITL/scene/cursor tempo 0, 
		/ITL/scene/cursor date 0, 
		/ITL/scene/javascript run "wsSend('STOP')"  
	);
	/ITL/scene watch GOTOMARK ( 
		/ITL/scene/cursor date '$(/ITL/scene/mark get date)',
		/ITL/scene/javascript run "goto('$(/ITL/scene/mark get date)')"
	);
	/ITL/scene watch GOTO ( 
		/ITL/scene/cursor date '$1' '$2',
		/ITL/scene event SENDGOTO
	);
	/ITL/scene watch SENDGOTO ( /ITL/scene/javascript run "goto('$(/ITL/scene/cursor get date)')" );
	

</pre>
</div>
<div class="help">
	<button onclick="showHelp(this)">Help</button> 
	<!-- <button onclick="wsSend('SYNC')">Sync</button> <span id=lat></span> -->
	<div id="helpid">
		Raccourcis clavier: 
		<ul>
			<li>'0' : renvoie au début de la partition.</li>
			<li>'1' : renvoie à la position du marqueur.</li>
			<li>'m' : positionne le marqueur à la date courante.</li>
			<li>espace : play/pause.</li>
		</ul>
	</div>
</div>


</body>

<script>
	function showHelp(ctrl) {
		let help = document.getElementById ('helpid');
		if (ctrl.innerHTML === "Help") {
			ctrl.innerHTML = "Hide";
			help.style.visibility = 'visible';
		}
		else {
			ctrl.innerHTML = "Help";
			help.style.visibility = 'hidden';
		}
	}
	connect ();

</script>

</html>
